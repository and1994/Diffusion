\documentclass[12pt]{article}

% compile this latex file with "pdflatex assig3Report"
% Lines staring with % are comments
% Graphics files are included with the \includegraphics command. 
% You will need to comment these out to use them.

% additional latex packages to use
\usepackage[a4paper, left=2.2cm,top=1.5cm, right=2.2cm,bottom=1.5cm,]{geometry}
\usepackage{times, graphicx, amsmath, mathtools}
\usepackage{url,multirow,xfrac}

% not so much space around floats
\renewcommand{\floatpagefraction}{0.95}
\renewcommand{\textfraction}{0}
\renewcommand{\topfraction}{1}
\renewcommand{\bottomfraction}{1}

\begin{document}
\thispagestyle{empty}

\title{MTMW12, Assignment 1: Diffusion}
\author{ID 25825273}
\maketitle


\begin{enumerate}

\item The numerical solution the one-dimensional diffusion equation
\begin{equation}
\frac{\partial\phi}{\partial t}=K\frac{\partial^{2}\phi}{\partial x^{2}}
\end{equation}
using the forward in time, centred in space (FTCS) and the backward
in time, centred in space (BTCS) diffusion schemes are shown in figure
\ref{fig:Q1}. These results use the initial conditions: 
\[
\phi_{0}(x)=\begin{cases}
1 & 0.4<x<0.6\\
0 & \text{ otherwise}
\end{cases}
\]
for $x\in[0,1]$ and are subject to boundary conditions $\partial\phi(0,t)/\partial x=\partial\phi(1,t)/\partial x=0$
for all time. The schemes use $n_{x}=41$ points in space and the
simulation runs for $n_{t}=40$ time-steps, each of length $\Delta t=0.1$s
using a diffusion number of $K=10^{-3}\text{m}^{2}\text{s}^{-1}$. The results are
compared with an analytic solution. The analytic solution assumes
an infinite domain.

\begin{figure}[!tbh]
\includegraphics[width=0.48\linewidth]{Question1.pdf}
\includegraphics[width=0.48\linewidth]{Question1_errors.pdf}

\caption{Results of FTCS and BTCS in comparison to the analytic solution. Results
use 41 points in space and the simulation runs for 40 time-steps,
each of length $\Delta t=0.1$s using a diffusion number of $K=10^{-3}\text{m}^{2}\text{s}^{-1}$, which yields $d=0.16$.
\label{fig:Q1}}
\end{figure}

It should be pointed out that the Von-Neumann stability analysis of the FTCS scheme tells us that in order to be using a neutrally stable numerical method the non-dimensional diffusion coefficient has to be less than 0.5, which is true for this particular case where $d=0.16$.


\item The one-dimensional diffusion equation can be used, for example, to
calculate the temperature distribution in a rod (or any similar unidimensional physical situation) and its variation in time. The particular initial conditions imposed could represent an initial temperature profile associated to a warm and sharply-constrained core (because of the step-function) in the middle of the rod, whereas the boundary conditions require that the system be isolated, i.e. not exchanging heat with the outside.

\item If we run the FTCS scheme for a sufficiently long duration, it gives then significantly different results from the analytic solution and this is due to the order of accuracy featured by this scheme, which is only first time-accurate. It can be seen from figure \ref{fig:Q3} that as the time increases the numerical solutions found with both FTCS and BTCS schemes remarkably diverge from the analytic solution.

\begin{figure}[!tbh]
\includegraphics[width=0.48\linewidth]{Question3(t=25).pdf}
\includegraphics[width=0.48\linewidth]{Question3(t=25)_errors.pdf}
\includegraphics[width=0.48\linewidth]{Question3(t=50).pdf}
\includegraphics[width=0.48\linewidth]{Question3(t=50)_errors.pdf}
\includegraphics[width=0.48\linewidth]{Question3(t=75).pdf}
\includegraphics[width=0.48\linewidth]{Question3(t=75)_errors.pdf}
\includegraphics[width=0.48\linewidth]{Question3(t=100).pdf}
\includegraphics[width=0.48\linewidth]{Question3(t=100)_errors.pdf}

\caption{Time-evolution of FTCS and BTCS in comparison to the analytic solution. Results
use 41 points in space and the simulation runs for 250, 500, 750 and 1000 time-steps,
each of length $\Delta t=0.1$s using a diffusion number of $K=10^{-3}\text{m}^{2}\text{s}^{-1}$, which yields $d=0.16$.
\label{fig:Q3}}
\end{figure}

\item To test the stability of the implementations of the FTCS and BTCS schemes a Von-Neumann stability analysis can be performed. This analysis guarantees a stable numerical solution of the FTCS scheme for values of the non-dimensional diffusion coefficient $d$ as follows,
\begin{equation}
d=K\frac{\Delta t}{{\Delta x}^2} \leq \frac{1}{2},
\end{equation}
whereas for the BTCS an unconditional stability is found for any value of the coefficient $d$.\par
In order to check whether this is true, the computation of the numerical solution can be performed using different values of the time step $\Delta t$, so that the coefficient $d$ be smaller or greater than 0.5.

\begin{figure}[!tbh]
\includegraphics[width=0.48\linewidth]{Q4_b(t=4).pdf}
\includegraphics[width=0.48\linewidth]{Q4_b(t=4)_errors.pdf}
\includegraphics[width=0.48\linewidth]{Q4_c(t=4).pdf}
\includegraphics[width=0.48\linewidth]{Q4_c(t=4)_errors.pdf}
\includegraphics[width=0.48\linewidth]{Q4_d(t=4).pdf}
\includegraphics[width=0.48\linewidth]{Q4_d(t=4)_errors.pdf}
\includegraphics[width=0.48\linewidth]{Q4_e(t=4).pdf}
\includegraphics[width=0.48\linewidth]{Q4_e(t=4)_errors.pdf}

\caption{Results of numerical computation using different values of non-dimensional parameter d with $K=10^{-3}\text{m}^{2}\text{s}^{-1}$ and $\Delta t$ fixed and different values for $\Delta x$. On the right of each solutions' graph the respective error graph is shown. Noticeable are the great extent of FTCS scheme's error in the last graph, due to its high instability for $d=1.44$, and the unconditional stability of the BTCS scheme.
\label{fig:Q4}}
\end{figure}

In figure \ref{fig:Q4} are presented the results of this experiments for different values of $d$ (refer to figure \ref{fig:Q1} for $d=0.16$): it can be noticed how the stability of the numerical method used in FTCS is affected by thickening the spatial grid on which the computation is performed. Similar results can be obtained if the spacial grid is fixed and the time steps are shortened, although this affects the stability in a more gradual way as $d\propto \Delta t$. \par
On the other hand, the BTCS scheme appears to be always stable, regardless of the value of $d$, as expected.

\item 




\end{enumerate}
\end{document}














